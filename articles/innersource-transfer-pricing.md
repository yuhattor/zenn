---
title: "インナーソースにおける移転価格"
emoji: "📝"
type: "idea" # tech: 技術記事 / idea: アイデア
topics: ["InnerSource", "インナーソース", "GitHub", "GitLab", "git"]
published: false
---

**InnerSource Commons Japan** ファウンダーの服部です。[InnerSource Commons](https://innersourcecommons.org/) ではインナーソース実践者や、学びたい方を幅広い活動でサポートしています。活動を始めるには [Slack](https://innersourcecommons-inviter.herokuapp.com/) のコミュニティにぜひご参加ください！


## インナーソースにおける移転価格

インナーソースはオープンソースに似たコードの共有・共創を社内で実践することです。この分野はカルチャーや組織構造の問題として取り扱われることが多い一方で、企業の中でインナーソースを実現するには会計や税務の問題もクリアする必要が出てくる場面があります。
この記事ではインナーソースにおける移転価格についてご紹介します。
InnerSource Summit 21 における Dirk Riehle教授の **"An Introduction to InnerSource and Transfer Pricing"** という講演も参照しておりますので、YouTube にある[本編](https://www.youtube.com/watch?v=75fR7tm2mPs)も是非ご参照ください。

### 移転価格とソフトウェア

移転価格とは、海外の関連会社間で取引される価格のことを言います。国際的に関連会社を有する企業はこの移転価格をどのように設定するのかによって、各国で納付する税金が大きく異なります。この移転価格はソフトウェアも例外ではなく、ソフトウェアの評価を適切に行った上で海外子会社へ移転しなければ、利益供与につながる可能性があります。

多方で、昨今のソフトウェア開発のトレンドを考えたとき、従来型の移転価格評価の考え方には不足する点があります。それは、アジャイルなどの開発手法をとるソフトウェアに対して "特定時点におけるスナップショット" としての価値評価を毎回するのが難しいということです。
ウォーターフォールのような工程分割タイプの開発においては、一般的に明示的なリリース日が設定されてことが多いですが、一方でアジャイルのように頻繁に機能が追加されるモデルでは、追加された機能を毎回評価する必要があるほか、使われなくなった機能を評価減させる必要もあります。
インナーソースも同様で、特定時点の開発物を共有する考え方ではなく、コードベースを共創して進化させていく考え方を持ちます。そのため価値評価に関しては同様の問題を抱えます。

オープンソースをみなさまが使う際、最終更新が5年前だったら使うのを躊躇いますよね。インナーソースも同様で、社内でただ共有されているだけの誰もメンテナンスしていないコードは多くの場合で意味を持ちません。近年「プロジェクトではなく、プロダクトで思考する」ということがよく言われますが、インナーソースの考え方も同様に、プロジェクトとして開発したものを共有する概念ではなく、コードをプロダクトとして開発する概念になります。

### インナーソースにおける差分の計算

ここま読んだ時におそらく思い浮かぶ方法が、「git のコミットごとに価値算定を行うのがいいのではないか」というアイデアだと思います。

InnerSource Commons のディレクターを務める Maximilian Capraro氏の研究では、組織単位全体の実際の作業の流れを測定する方法を開発について述べられています。詳しくは[論文](https://capraro.net/assets/publications/C20%20Measuring%20Inner%20Source%20Collaboration.pdf)をご覧ください。研究の中では、ケーススタディ企業の組織ユニットからプロジェクト、別の組織ユニットのコードリポジトリにコードがどのように流れたかを説明されていますが。
![移転価格のフロー](/images/innersource-transfer-pricing/transfer-pricing-flow.png "Maximilian Capraro (2019) Measuring Inner Source Collaboration")
Maximilian Capraro (2019). Measuring Inner Source Collaboration

しかし、各コミットが各機能のタスクに紐づくトランザクションであることは非常に重要ですが、純粋にこのコミットレベルの観点を採用したくはありません。
![コミット](images/innersource-transfer-pricing/commit.png "")
